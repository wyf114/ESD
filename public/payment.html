<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESD Airline</title>
    <!-- load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
    <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css"> <!-- Font Awesome -->
    <link rel="stylesheet" href="css/bootstrap.min.css"> <!-- Bootstrap style -->
    <link rel="stylesheet" type="text/css" href="css/datepicker.css" />
    <link rel="stylesheet" href="css/templatemo-style.css"> <!-- Templatemo style -->
    <link rel="stylesheet" href="css/payment.css">
    <link rel="stylesheet" href=" https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css">
    <!-- Bootstrap style -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <meta name = "google-signin-client_id" content="648525575446-vn5s4huqmidti2blbgbg0emnb0ml7887.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="js/paymentprocess.js"></script>
</head>

<body onload="showPayment()">
    
    <div class="tm-main-content" id="top">
        <div class="tm-top-bar-bg"></div>
        <div class="tm-top-bar" id="tm-top-bar">
            <div class="container">
                <div class="row">
                    <nav class="navbar navbar-expand-lg narbar-light">
                        <a class="navbar-brand mr-auto" href="index.html">
                            <img src="img/logo.png" alt="Site logo">
                            ESD Airline
                        </a>
                        <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse"
                            data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                            <ul class="navbar-nav ml-auto">
                                <li class="nav-item">
                                    <a class="nav-link" href="index.html">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="mybooking.html">My booking</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">Contact Us</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id = "gbutton"><div class="g-signin2" data-onsuccess="onSignIn"></div></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="emailTxt"></a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div> <!-- row -->
            </div> <!-- container -->
        </div> <!-- .tm-top-bar -->


<!-- ---payment--- -->
    <div class="container">
        <div class="main-inner container-center" id="main">
            <div class="show-message-component"></div> <!----> <!----> 
            <div><div class="heading-wrapper"><h2 class="main-heading"></h2>

        <div class="heading-wrapper">
            <h2 class="main-heading">Review your booking</h2> 
            <!-- <p class="text-info">Review your booking and complete your payment and authentication within 8 minutes, or this booking session may expire.</p> -->
        </div>
        </div>

    <section class="payment-accordion-container">
        <div class="v-collapse-group accordion-wrapper">
            <div class="accordion-item vc-collapse">
                <div id="itinerary" class="accordion-header v-collapse-toggler active">
                    <a><div class="accordion-title"><h4><strong>Itinerary</strong></h4></div> 
                        <div class="accordion-subtotal" id="">
                            <span>Subtotal </span> 
                            
                            <!----> <span class="sub-currency">SGD</span> <span class="sub-price">(amount)</span> 
                            
                            <span class="ico-chevron--blue"></span></div></a></div> 
                            <div class="accordion-body v-collapse-content v-collapse-content-end">
                                <div class="booking-info-section">
                                    <section id="itinerary">
                                        <div class="accordion-content">
                                            <div class="itinerary-top">
                                                <h4 class="flight-info-title"  id="flightNumber">SQ706

                                                <span> - </span>
                                                <span id="originCode">SIN</span> 
                                                <span>to</span> 
                                                <span id="desCode">BKK</span> 

        <!----> <!---->
    </div> 
    <div class="itinerary-inner">
        <!-- <span class="stop-time">Depart Date: </span>  -->
        <div class="flight-station-info">
            Depart Date:<span id="departDate"><strong> 2022-04-11</strong> </span> </br>
            Depart Time:<span id="departTime"> 07:10 </span> </br>
            Arrive Time:<span id="arriveTime"> 08:35 </span> </br>

        </div> 
    </div>
 
    <div class="flight-stop" >
        <span class="flight-stop-detail">
            <em class="ico-airplane-2"></em> <hr> 
            <span class="flight-place"></span></div> 
            <div class="airline-info">   
        <h4 class="flight-info-title" id="flightNumber2">SQ705
       
            <span> - </span>
            <span id="originCode2">BKK</span> 
            <span>to</span> 
            <span id="desCode2">SIN</span> 
        </h4>
        </div>
        <div class="itinerary-inner">
        <!-- <span class="stop-time">Depart Date: </span>  -->
        <div class="flight-station-info">
            Depart Date:<span id="departDate2"><strong> 2022-04-15</strong> </span> </br>
            Depart Time:<span id="departTime2"> 09:40</span> </br>
            Arrive Time:<span id="arriveTime2"> 13:05</span> </br>

        </div> 
    </div>
        
        
    </div></div></div></section> 
</br>
    <p class="fw-bold">Grand Total</p>
        <p id="price" class="fw-bold" style="text-align: right; font-size: large;"><span class="fas fa-dollar-sign" ></span id='price'>436.2</p>

                        <!-- </div> -->
                        </br>

                        <!-- <p id="email" style="display: none"></p> -->
                        <!-- change this -->
                    </br>
                        <div id="smart-button-container">
                            <div style="text-align: center;">
                              <div id="paypal-button-container"></div>
                            </div>
                          </div>
                        <script src="https://www.paypal.com/sdk/js?client-id=sb&enable-funding=venmo&currency=USD" data-sdk-integration-source="button-factory"></script>
                        <!-- -- -->
                    </div>

                </div>
            </div>
        </form>
    </div>
</div>
</div>


<footer class="tm-container-outer">
    <p class="mb-0">Done by ESD Team 7</p>
</footer>
</div>
<script>
$(window).on("scroll", function () {
    if ($(window).scrollTop() > 100) {
        $(".tm-top-bar").addClass("active");
    } else {
        $(".tm-top-bar").removeClass("active");
    }
});

function onSignIn(googleUser) {
    var profile = googleUser.getBasicProfile();
    console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
    console.log('Name: ' + profile.getName());
    console.log('Image URL: ' + profile.getImageUrl());
    console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
    localStorage.setItem("email", profile.getEmail());
    // console.log(localStorage.getItem("email"));
    var element = document.querySelector('#gbutton')
    element.innerHTML = '<a href = "payment.html" onclick="signOut()">Sign out</a>';

    var emailTxt= document.getElementById('emailTxt');
    }

    function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
            console.log('User signed out.');
            auth2.disconnect();
            });
        }


 
    paypal.Buttons({
    style: {
        shape: 'rect',
        color: 'gold',
        layout: 'vertical',
        label: 'paypal',
        
    },

    createOrder: function(data, actions) {
        var price = 436.2;
        return actions.order.create({
        purchase_units: [{"amount"
            :{"currency_code":"USD","value": price}}]
        });
    },

    onApprove: function(data, actions) {
        return actions.order.capture().then(function(orderData) {
        
        // Full available details
        console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
        console.log(typeof(orderData))
        var paymentData = JSON.stringify(orderData, null, 2)
        // Show a success message within this page, e.g.

        const element = document.getElementById('paypal-button-container');
        element.innerHTML = '';
        element.innerHTML = '<h3>Thank you for your payment!</h3>';
        
        localStorage.setItem("paymentData", paymentData);
        window.location.replace('http://localhost:5500/public/bookingdetails.html')

        });
    },

    onError: function(err) {
        console.log(err);
    }
    }).render('#paypal-button-container');


</script>

<!-- <script src="js/paymentprocess.js"></script> -->
</body>

<!-- <script src="js/paymentprocess.js"></script> -->
</html>